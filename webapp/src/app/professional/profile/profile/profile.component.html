<div class="container">
  <mat-card>
    <form [formGroup]="form" novalidate>
      <mat-card-title>Profil</mat-card-title>
      <mat-card-subtitle>Email : {{pro.email}}</mat-card-subtitle>
      <div class="top-button-container">
        <button type="button" mat-raised-button color="primary" routerLink="./change-password" routerLinkActive="active">
          Nouveau mot de passe
        </button>
        <button *ngIf="hasActiveSubscription" type="button" mat-raised-button color="primary" routerLink="./subscription-details" routerLinkActive="active">
          Abonnement
        </button>
        <button *ngIf="newSubscriptionAllowed" type="button" mat-raised-button color="accent" routerLink="./subscribe" routerLinkActive="active">
          Nouvelle souscription
        </button>
        <a href="/cgvu.pdf" target="_blank" mat-raised-button color="primary">CGV / CGU</a>
      </div>

      <mat-card-content>

        <mat-accordion multi="false">

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Compte {{appName}} *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-account-info [errorAggregator]="errorAggregator"></app-account-info>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Société / Entreprise *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-company-information [errorAggregator]="errorAggregator"></app-company-information>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Activités *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-businesses [errorAggregator]="errorAggregator"></app-businesses>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Moyens d'encaissement acceptés *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-payment-modes [errorAggregator]="errorAggregator"></app-payment-modes>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Identité du Dirigeant *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-customer-details [errorAggregator]="errorAggregator"></app-customer-details>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Adresse de l'entreprise *
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-address [errorAggregator]="errorAggregator"></app-address>
          </mat-expansion-panel>

          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Réseaux sociaux
              </mat-panel-title>
            </mat-expansion-panel-header>
            <app-social-network-accounts [errorAggregator]="errorAggregator"></app-social-network-accounts>
          </mat-expansion-panel>

        </mat-accordion>
      </mat-card-content>
      <ng-container appErrorAggregator></ng-container>
      <mat-card-actions>
        <div class="form-button-container">
          <button type="button" matTooltip="Annuler les modification" mat-mini-fab color="accent" (click)="revert()" [disabled]="form.pristine">
            <mat-icon aria-label="Annuler les modification">undo</mat-icon>
          </button>
          <button type="button" matTooltip="Rafraîchir le profil avec les données du serveur" mat-mini-fab color="accent" (click)="refresh()">
            <mat-icon aria-label="Rafraîchir le profil avec les données du serveur">refresh</mat-icon>
          </button>
          <button type="button" matTooltip="Valider la mise à jour du profil" mat-mini-fab color="primary" (click)="save()" [disabled]="form.pristine || form.invalid">
            <mat-icon aria-label="Valider la mise à jour du profil">done</mat-icon>
          </button>
        </div>
      </mat-card-actions>
    </form>
  </mat-card>
</div>